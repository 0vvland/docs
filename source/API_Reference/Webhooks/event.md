---
layout: page
weight: 0
title: Event Webhook
navigation:
  show: true
---

{% info %}
Available to Bronze and higher packages or to our free demo accounts. 
{% endinfo %}

SendGrid's Event Webhook will notify a URL of your choice via HTTP POST with information about events that occur as SendGrid processes your email. Common uses of this data are to remove unsubscribes, react to spam reports, [determine unengaged recipients](http://sendgrid.com/blog/infer-engagement-with-the-event-api/), identify bounced email addresses or create advanced analytics of your email program. With Unique Arguments and Category parameters, you can insert dynamic data that will help build a sharp, clear image of your mailings.

{% info %}
If you'd like to see how one of our customers uses the Event Webhook, check out [Leveraging SendGrid's Event API](http://blog.sendgrid.com/leveraging-sendgrids-event-api/). 
{% endinfo %}

{% info %}
There are a number of pre-made integrations for the SendGrid Event Webhook, to make processing events easy, find them in the [Library Index]({{root_url}}/Integrate/libraries.html#-Webhook-Libraries). 
{% endinfo %}

{% anchor h2 %}
Setup 
{% endanchor %}

To setup the Event Webhook via our web interface, login and go to the [apps page](http://sendgrid.com/app), click on Show Disabled Apps, click the Event Notification app, and click on settings. Check the boxes next to the type of events you want posted to your web server, then enter in the URL you have setup to receive POSTs from our servers when an event occurs.

The Event Webhook may also be setup by using our [Filter Settings Endpoint]({{root_url}}/API_Reference/Web_API/filter_settings.html#-Event-Notification).

{% info %}
We support basic HTTP authentication in our Event API. Those who wish to implement can provide credentials in the post event url field on the app settings page. Below is an example of the post url with authentication included. 
{% endinfo %}

{% codeblock lang:html %}
http(s)://username:password@domain/foo.php
{% endcodeblock %}

 
{% warning %}
If you wish to receive encrypted posts, we require that your callback URL support SSL v2. 
{% endwarning %}

{% anchor h2 %}
Requests 
{% endanchor %}

You will receive a **HTTP POST** containing a JSON array of multiple events in one request after a very short delay. These POSTs will be sent to the URL you have defined in the Event Notification app options.

{% info %}
Events currently post every 1 second or when the batch size reaches 1MB (one megabyte), whichever occurs first. This is per server, so the webhook URL may receive tens of posts per second. 
{% endinfo %}

{% anchor h3 %}
Event POST Example 
{% endanchor %}

{% codeblock lang:json %}
[
  {
    "email": "john.doe@sendgrid.com",
    "timestamp": 1337197600,
    "smtp-id": "<4FB4041F.6080505@sendgrid.com>",
    "event": "processed"
  },
  {
    "email": "john.doe@sendgrid.com",
    "timestamp": 1337966815,
    "category": "newuser",
    "event": "click",
    "url": "http://sendgrid.com"
  },
  {
    "email": "john.doe@sendgrid.com",
    "timestamp": 1337969592,
    "smtp-id": "<20120525181309.C1A9B40405B3@Example-Mac.local>",
    "event": "processed"
  }
]
{% endcodeblock %}

You can test your endpoint by clicking the "Test Your Integration" button on the setup screen. SendGrid will send a simulated POST of events to your callback url. At this time, our testing tool does not support HTTP basic authentication, so you must disable auth on your app while debugging.

SendGrid expects a 200 HTTP response to the POST, otherwise the event notification will be retried. If your URL returns a non-200 HTTP code it will be deferred and retried for 24 hours. The maximum number of deferred POSTs in the retry queue is 100,000. If the queue is full, the oldest request in the queue will be removed to make room for the newest deferred POST. Events that cannot be submitted within the maximum retry period or events removed from the defer queue will be lost.

{% warning %}
If your email traffic generates lots of events, the incoming data can easily overload a web server if not configured properly. You can load test your endpoints with [loader.io](http://loader.io) for free. 
{% endwarning %}

{% anchor h2 %}
Event Types 
{% endanchor %}

The following lists the events generated by SendGrid.



The following image shows where events can be generated as email is being processed:

![]({{root_url}}/images/event_1.png "Event Flow")

{% anchor h2 %}
Default Parameters for Delivery Events 
{% endanchor %}

The following parameters are sent with delivery events: bounce, deferred, delivered, dropped, and processed events. Some events may include additional parameters.



{% anchor h2 %}
Default Parameters for Engagement Events 
{% endanchor %}

The following parameters are sent with engagement events: click, open, spamreport, and unsubscribe events. Some events may include additional parameters.



{% anchor h2 %}
Unique Arguments and Categories 
{% endanchor %}

Events generated by SendGrid can also include unique arguments. To define and receive custom parameters in your URL the [SMTP API]({{root_url}}/API_Reference/SMTP_API/index.html) must be used when sending emails using the *unique_args* argument. For example, if you have an application and want to receive custom parameters such as the `userid` and the email `template`, you would submit them in the SMTP API header or parameter, as described on the [Unique Arguments documentation page]({{root_url}}/API_Reference/SMTP_API/unique_arguments.html), they would then be returned in the events like so:

{% codeblock lang:json %}
[
  {
    "email": "john.doe@sendgrid.com",
    "timestamp": 1337966815,
    "event": "click",
    "url": "http://sendgrid.com",
    "userid": "1123",
    "template": "welcome"
  }
]
{% endcodeblock %}

 
{% anchor h2 %}
Categories 
{% endanchor %}

If [categories]({{root_url}}/Delivery_Metrics/categories.html) are used over the SMTP API they will be returned by the Event Webhook as such:

{% codeblock lang:json %}
[
  {
    "email": "john.doe@sendgrid.com",
    "timestamp": 1337966815,
    "category": [
      "newuser",
      "transactional"
    ],
    "event": "open"
  },
  {
    "email": "jane.doe@sendgrid.com",
    "timestamp": 1337966815,
    "category": "olduser",
    "event": "open"
  }
]
{% endcodeblock %}

 
{% info %}
If you apply multiple categories to any of your outgoing messages, the returned data will be in the form of an array, if there's only one category, however, it will be returned as a string. 
{% endinfo %}

{% anchor h2 %}
Example 
{% endanchor %}
The following example uses PHP to store webhook requests in `/tmp/dump.log`: 

{% codeblock lang:php %}
<?php
$fh = fopen('/tmp/dump.log', 'a+');
if ( $fh )
{
// Dump body
fwrite($fh, print_r($HTTP_RAW_POST_DATA, true));
fclose($fh);
}

echo "ok";
?>
{% endcodeblock %}

 
{% anchor h2 %}
Parameter Details 
{% endanchor %}

The following shows each type of event that can be posted along with the specific parameters that go along with the event.

{% info %}
You can use the SMTP API to specify additional custom parameters including categories and unique args. Each unique arg is posted as a separate post parameter, similar to the category listed below, but with a custom name specified by you. 
{% endinfo %}

{% anchor h2 %}
Processed 
{% endanchor %}



{% anchor h2 %}
Deferred 
{% endanchor %}



{% anchor h2 %}
Delivered 
{% endanchor %}



{% anchor h2 %}
Open 
{% endanchor %}



{% anchor h2 %}
Click 
{% endanchor %}



{% anchor h2 %}
Bounce 
{% endanchor %}



{% anchor h2 %}
Drop 
{% endanchor %}



{% anchor h2 %}
Spam Report 
{% endanchor %}



{% anchor h2 %}
Unsubscribe 
{% endanchor %}



{% anchor h2 %}
Marketing Email Unsubscribes 
{% endanchor %}

For emails sent through our Marketing Email tool, unsubscribes look like the following example:

{% codeblock lang:json %}
[
  {
    "email": "nick@sendgrid.com",
    "timestamp": 1380822437,
    "newsletter": {
      "newsletter_user_list_id": "10557865",
      "newsletter_id": "1943530",
      "newsletter_send_id": "2308608"
    },
    "category": [
      "Tests",
      "Newsletter"
    ],
    "event": "unsubscribe"
  }
]
{% endcodeblock %}

 
{% anchor h2 %}
Troubleshooting 
{% endanchor %}

Ensure that your web server is returning a 200 response to our servers. Any other response type will result in our server retrying a POST until we receive a 200 response or the maximum time has expired. All events are retried at increasing intervals for up to 24 hours after the event occurs. Make sure you are not blocking our IPs that are trying to POST to your server. Our IPs change often since we constantly add more machines.

You can use the "Test Your Integration" button on the Event Notifications settings page to send simulated events to your callback URL. You can also send a POST from a shell using cURL. This will give you the full response your server is returning including the HTTP headers.

{% codeblock lang:bash %}
curl -X POST -H "Content-Type: application/json" -d '[{"email":"john.doe@sendgrid.com","timestamp":1337197600,"smtp-id":"<4FB4041F.6080505@sendgrid.com>","event":"processed"},{"email":"john.doe@sendgrid.com","timestamp":1337966815,"category":"newuser","event":"click","url":"http://sendgrid.com"},{"email":"john.doe@sendgrid.com","timestamp":1337969592,"smtp-id":"<20120525181309.C1A9B40405B3@Example-Mac.local>","event":"processed"}]'
{% endcodeblock %}

 
{% anchor h2 %}
Version Differences 
{% endanchor %}
The primary difference between v2 (no longer available) and v3 of the Event Webhook is Version 3 deliverers events as JSON arrays, whereas the previous version delivered batched JSON as JSON documents separated by line breaks. Further, v3 provides more data with certain events. The [previous version of the webhook's documentation](http://sendgrid.com/docs/API_Reference/Webhooks/event_deprecated.html%20) is still provided so you may compare.
